## 用作备份系统
# rsync -aAXv --exclude={"/dev/*","/proc/*","/sys/*","/tmp/*","/run/*","/mnt/*","/media/*","/lost+found"} / /home/user/backup

完整系统备份
使用rsync传输整个/树的副本，其中不包括几个选定的文件夹。这种方法被认为比使用dd进行磁盘克隆更好，因为它允许使用不同的大小，分区表和文件系统，并且也比使用cp -a复制更好，因为它可以更好地控制文件权限，属性，访问控制列表和扩展属性。

即使在系统运行时，rsync也可以工作，但是在传输过程中更改的文件可能会也可能不会传输，这可能会导致某些使用已传输文件的程序出现不确定的行为。

该方法非常适合将现有安装迁移到新的硬盘驱动器或SSD。

以超级用户身份运行以下命令，以确保rsync可以访问所有系统文件并保留所有权：

通过使用-aAX选项集，可以在归档模式下传输文件，这可以确保假设目标文件系统支持该功能，则可以保留符号链接，设备，权限，所有权，修改时间，ACL和扩展属性。

--exclude选项将排除与给定模式匹配的文件。 /dev, /proc, /sys, /tmp, 和 /run的内容在上面的命令中被排除，因为它们是在引导时填充的，尽管没有创建文件夹本身。 / lost + found是特定于文件系统的。上面的命令取决于bash和zsh shell中可用的大括号扩展。当使用其他shell时，应手动重复--exclude模式。引用排除模式将避免外壳扩展，这是必需的，例如，在通过SSH备份时。以*结束排除的路径可确保目录本身（如果尚不存在）将被创建。

注意：
如果您打算在/ mnt或/ media之外的其他地方备份系统，请不要忘记将其添加到排除模式列表中，以免发生无限循环。
如果系统中有任何绑定安装，则也应将它们排除在外，以使绑定安装的内容仅被复制一次。
如果您使用交换文件，请确保也将其排除在外。
考虑是否要备份/home/文件夹。如果它包含您的数据，则可能比系统大得多。否则，请考虑排除不重要的子目录，例如/home/*/.thumbnails/*、/home/*/.cache/mozilla/*、/home/*/.cache/chromium/*和/home/*/.local/share/Trash/*，具体取决于系统上安装的软件。
如果安装了GVFS，则必须排除/home/*/.gvfs，以防止出现rsync错误。

如果您使用许多硬链接（例如，如果您使用Flatpak），请考虑添加-H选项，由于其内存消耗，该选项默认情况下处于关闭状态；但是，在大多数现代机器上应该没有问题。许多硬链接位于/ usr /目录下。
如果您多次将rsync的--delete选项运行到同一备份文件夹，则可能需要添加。在这种情况下，请确保源路径不以/ *结尾，否则此选项仅对源目录的子目录内的文件有效，而对直接位于源目录内的文件不起作用。
如果您使用任何稀疏文件，例如虚拟磁盘，Docker映像等，则应添加-S选项。
--numeric-ids选项将禁用用户名和组名的映射；而是将传送数字组和用户ID。通过SSH备份或使用实时系统备份其他系统磁盘时，此功能很有用。
选择--info = progress2选项而不是-v将显示总体进度信息和传输速度，而不是正在传输的文件列表。
为避免递归时跨越文件系统边界，请添加选项-x /-one-file-system。这将防止备份层次结构中的任何安装点。


恢复
rsync -qaHAXS 源文件_DIR 目标文件_DIR
